<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Comprehensive WCAG 2.1 AA accessibility audit with semantic HTML, ARIA, keyboard navigation, and color contrast analysis">
    <title>Accessibility Audit Report - tkr-project-kit</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../assets/css/base.css">
    <link rel="stylesheet" href="../../assets/css/themes/light.css">
    <link rel="stylesheet" href="../../assets/css/themes/dark.css">
    <link rel="stylesheet" href="../../assets/css/components/cards.css">
    <link rel="stylesheet" href="../../assets/css/components/badges.css">
    <link rel="stylesheet" href="../../assets/css/components/tables.css">
    <link rel="stylesheet" href="../../assets/css/components/progress.css">
    <link rel="stylesheet" href="../../assets/css/components/buttons.css">
    <link rel="stylesheet" href="../../assets/css/components/navigation.css">

    <!-- Report Configuration -->
    <script>
        window.REPORT_CONFIG = {
            reportType: 'accessibility-report',
            reportDate: '2025-01-30',
            reportTitle: 'Accessibility Audit Report',
            agent: 'accessibility-agent'
        };
    </script>
</head>
<body>
    <div class="container">
        <!-- Breadcrumbs -->
        <div id="breadcrumbs"></div>

        <!-- Header -->
        <header>
            <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 1rem;">
                <div style="flex: 1;">
                    <h1>‚ôø Accessibility Audit Report</h1>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-lg); margin-top: 0.5rem;">
                        Comprehensive WCAG 2.1 AA accessibility audit with semantic HTML, ARIA, keyboard navigation, and color contrast analysis
                    </p>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 0.5rem; color: var(--color-text-tertiary); font-size: var(--font-size-sm);">
                        <span>üìÖ Generated: 2025-01-30</span>
                        <span>ü§ñ Agent: accessibility-agent</span>
                        <span>üìä Version: 3.6.0</span>
                    </div>
                </div>
                <div id="theme-toggle-container"></div>
            </div>
        </header>

        <!-- Quick Navigation -->
        <div id="report-navigation"></div>

        <!-- Main Content -->
        <main>
            
<!-- Executive Summary -->
<div class="section">
    <h2>Executive Summary</h2>
    <div class="score-card" style="background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%); color: white; padding: 2rem; border-radius: 0.75rem; margin-bottom: 1.5rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
            <div>
                <div style="font-size: 3rem; font-weight: bold;">62%</div>
                <div style="font-size: 1.25rem; opacity: 0.9;">WCAG 2.1 AA Compliance</div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 1.5rem; font-weight: 600;">17 Issues Found</div>
                <div style="opacity: 0.9;">6 Critical ‚Ä¢ 8 Warning ‚Ä¢ 3 Info</div>
            </div>
        </div>
    </div>

    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
        <div class="card">
            <h3 style="color: var(--color-error); margin-bottom: 0.5rem;">6 Critical</h3>
            <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">Must fix for compliance</p>
        </div>
        <div class="card">
            <h3 style="color: var(--color-warning); margin-bottom: 0.5rem;">8 Warnings</h3>
            <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">Should be addressed</p>
        </div>
        <div class="card">
            <h3 style="color: var(--color-info); margin-bottom: 0.5rem;">3 Informational</h3>
            <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm);">Enhancement opportunities</p>
        </div>
    </div>

    <div class="card">
        <h3>Key Findings</h3>
        <ul style="margin-top: 1rem; line-height: 1.8;">
            <li><strong>Semantic HTML:</strong> 4 violations - Missing heading hierarchy, improper landmark usage</li>
            <li><strong>ARIA Implementation:</strong> 5 violations - Redundant ARIA, missing labels, improper roles</li>
            <li><strong>Keyboard Navigation:</strong> 3 violations - Missing focus indicators, tab order issues</li>
            <li><strong>Color Contrast:</strong> 3 violations - Text contrast below 4.5:1 ratio</li>
            <li><strong>Screen Reader:</strong> 2 violations - Missing alt text, improper announcements</li>
        </ul>
    </div>
</div>

<!-- WCAG 2.1 AA Compliance Status -->
<div class="section">
    <h2>WCAG 2.1 AA Compliance Status</h2>
    
    <div class="card" style="margin-bottom: 1.5rem;">
        <h3>Success Criteria Breakdown</h3>
        <table>
            <thead>
                <tr>
                    <th>Principle</th>
                    <th>Guideline</th>
                    <th>Status</th>
                    <th>Issues</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td rowspan="4"><strong>Perceivable</strong></td>
                    <td>1.1 Text Alternatives</td>
                    <td><span class="badge badge-warning">Partial</span></td>
                    <td>2 violations</td>
                </tr>
                <tr>
                    <td>1.3 Adaptable</td>
                    <td><span class="badge badge-error">Failing</span></td>
                    <td>4 violations</td>
                </tr>
                <tr>
                    <td>1.4 Distinguishable</td>
                    <td><span class="badge badge-warning">Partial</span></td>
                    <td>3 violations</td>
                </tr>
                <tr>
                    <td>Total</td>
                    <td></td>
                    <td><strong>9 issues</strong></td>
                </tr>
                <tr>
                    <td rowspan="3"><strong>Operable</strong></td>
                    <td>2.1 Keyboard Accessible</td>
                    <td><span class="badge badge-warning">Partial</span></td>
                    <td>2 violations</td>
                </tr>
                <tr>
                    <td>2.4 Navigable</td>
                    <td><span class="badge badge-warning">Partial</span></td>
                    <td>3 violations</td>
                </tr>
                <tr>
                    <td>Total</td>
                    <td></td>
                    <td><strong>5 issues</strong></td>
                </tr>
                <tr>
                    <td><strong>Understandable</strong></td>
                    <td>3.1 Readable</td>
                    <td><span class="badge badge-success">Pass</span></td>
                    <td>0 violations</td>
                </tr>
                <tr>
                    <td rowspan="2"><strong>Robust</strong></td>
                    <td>4.1 Compatible</td>
                    <td><span class="badge badge-warning">Partial</span></td>
                    <td>3 violations</td>
                </tr>
                <tr>
                    <td>Total</td>
                    <td></td>
                    <td><strong>3 issues</strong></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Semantic HTML Analysis -->
<div class="section">
    <h2>Semantic HTML Violations</h2>
    
    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-error);">
        <div style="display: flex; justify-content: between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-error);">Missing Main Landmark</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.3.1 Info and Relationships (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Critical</p>
            </div>
            <span class="badge badge-error">Critical</span>
        </div>
        <p style="margin: 1rem 0;">The dashboard lacks a <code>&lt;main&gt;</code> landmark element. All primary content is wrapped in generic <code>&lt;div&gt;</code> elements.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:1616-1807</code></p>
        
        <h4>Current Code:</h4>
        <pre><code>&lt;div className="min-h-screen bg-gray-50 dark:bg-gray-900"&gt;
  &lt;!-- Sidebar --&gt;
  &lt;div className="fixed inset-y-0 left-0 z-50 w-64"&gt;...&lt;/div&gt;
  
  &lt;!-- Main Content --&gt;
  &lt;div className="lg:ml-64"&gt;
    &lt;header&gt;...&lt;/header&gt;
    &lt;main className="p-4 sm:p-6 lg:p-8"&gt;
      {/* Content here */}
    &lt;/main&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
        
        <h4>Recommended Fix:</h4>
        <pre><code>&lt;div className="min-h-screen bg-gray-50 dark:bg-gray-900"&gt;
  &lt;nav aria-label="Main navigation" className="fixed inset-y-0 left-0 z-50 w-64"&gt;...&lt;/nav&gt;
  
  &lt;div className="lg:ml-64"&gt;
    &lt;header&gt;...&lt;/header&gt;
    &lt;main id="main-content" className="p-4 sm:p-6 lg:p-8"&gt;
      {/* Content here */}
    &lt;/main&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
        
        <p style="margin-top: 1rem;"><strong>Impact:</strong> Screen reader users cannot quickly navigate to main content. Skip links won't function properly.</p>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-error);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-error);">Improper Heading Hierarchy</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.3.1 Info and Relationships (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Critical</p>
            </div>
            <span class="badge badge-error">Critical</span>
        </div>
        <p style="margin: 1rem 0;">Multiple H2 headings appear before H1, and heading levels are skipped throughout the dashboard.</p>
        
        <h4>Issues Found:</h4>
        <ul>
            <li>H1 appears at line 1632: "TKR Dashboard" (correct)</li>
            <li>H2 appears at line 584 in LogViewer before H1 context</li>
            <li>H3 headings in ServiceHealthCard (line 268) lack H2 parent</li>
        </ul>
        
        <h4>Recommended Fix:</h4>
        <p>Ensure logical heading hierarchy: H1 (page title) ‚Üí H2 (sections) ‚Üí H3 (subsections)</p>
        <pre><code>&lt;!-- Dashboard structure --&gt;
&lt;h1&gt;TKR Dashboard&lt;/h1&gt; {/* Page title */}

&lt;section aria-labelledby="overview-heading"&gt;
  &lt;h2 id="overview-heading"&gt;Overview&lt;/h2&gt;
  {/* Stats cards */}
&lt;/section&gt;

&lt;section aria-labelledby="services-heading"&gt;
  &lt;h2 id="services-heading"&gt;Services&lt;/h2&gt;
  &lt;article&gt;
    &lt;h3&gt;API Gateway&lt;/h3&gt;
  &lt;/article&gt;
&lt;/section&gt;</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Missing Navigation Landmark</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 2.4.1 Bypass Blocks (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Sidebar navigation uses generic div instead of <code>&lt;nav&gt;</code> element.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:1625-1667</code></p>
        
        <h4>Recommended Fix:</h4>
        <pre><code>&lt;nav aria-label="Main navigation" className="p-4 space-y-1"&gt;
  &lt;ul role="list" style="list-style: none; padding: 0;"&gt;
    {navigation.map((item) =&gt; (
      &lt;li key={item.id}&gt;
        &lt;button
          onClick={() =&gt; handleViewChange(item.id)}
          aria-current={activeView === item.id ? 'page' : undefined}
          className={...}
        &gt;
          &lt;Icon className="w-5 h-5" aria-hidden="true" /&gt;
          {item.name}
        &lt;/button&gt;
      &lt;/li&gt;
    ))}
  &lt;/ul&gt;
&lt;/nav&gt;</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Unlabeled Search Region</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.3.1 Info and Relationships (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Search inputs lack proper labeling and semantic structure.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:587-594</code></p>
        
        <h4>Current Code:</h4>
        <pre><code>&lt;div className="relative"&gt;
  &lt;Search className="absolute left-3..." /&gt;
  &lt;input
    type="text"
    placeholder="Search logs..."
    value={searchTerm}
    onChange={(e) =&gt; setSearchTerm(e.target.value)}
    className="..."
  /&gt;
&lt;/div&gt;</code></pre>
        
        <h4>Recommended Fix:</h4>
        <pre><code>&lt;div className="relative" role="search"&gt;
  &lt;label htmlFor="log-search" className="sr-only"&gt;Search logs&lt;/label&gt;
  &lt;Search className="absolute left-3..." aria-hidden="true" /&gt;
  &lt;input
    id="log-search"
    type="search"
    placeholder="Search logs..."
    value={searchTerm}
    onChange={(e) =&gt; setSearchTerm(e.target.value)}
    aria-label="Search system logs"
    className="..."
  /&gt;
&lt;/div&gt;</code></pre>
    </div>
</div>

<!-- ARIA Implementation Review -->
<div class="section">
    <h2>ARIA Implementation Issues</h2>
    
    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-error);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-error);">Missing ARIA Labels on Icon Buttons</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 4.1.2 Name, Role, Value (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Critical</p>
            </div>
            <span class="badge badge-error">Critical</span>
        </div>
        <p style="margin: 1rem 0;">Multiple icon-only buttons lack accessible labels.</p>
        
        <h4>Issues Found:</h4>
        <ul>
            <li>Theme toggle button (line 1685) - Missing aria-label</li>
            <li>Mobile menu toggle (line 1675) - Missing aria-label</li>
            <li>Sidebar close button (line 1641) - Missing aria-label</li>
            <li>Modal close button (line 820) - Missing aria-label</li>
        </ul>
        
        <h4>Example - Theme Toggle:</h4>
        <pre><code>&lt;!-- Current (BAD) --&gt;
&lt;button
  onClick={cycleTheme}
  className="p-2 text-gray-400..."
  title={`Theme: ${theme} (click to cycle)`}
&gt;
  {React.createElement(getThemeIcon(), { className: "w-5 h-5" })}
&lt;/button&gt;

&lt;!-- Fixed (GOOD) --&gt;
&lt;button
  onClick={cycleTheme}
  className="p-2 text-gray-400..."
  aria-label={`Current theme: ${theme}. Click to cycle themes`}
  title={`Theme: ${theme}`}
&gt;
  {React.createElement(getThemeIcon(), { 
    className: "w-5 h-5",
    "aria-hidden": "true" 
  })}
&lt;/button&gt;</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-error);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-error);">Redundant ARIA on Buttons</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 4.1.2 Name, Role, Value (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Critical</p>
            </div>
            <span class="badge badge-error">Critical</span>
        </div>
        <p style="margin: 1rem 0;">Buttons have role="button" explicitly set, which is redundant and may cause issues.</p>
        
        <h4>Location:</h4>
        <p>Multiple button elements throughout components</p>
        
        <h4>Issue:</h4>
        <p>Native <code>&lt;button&gt;</code> elements already have implicit role="button". Adding it explicitly is redundant per ARIA First Rule of ARIA.</p>
        
        <h4>Recommendation:</h4>
        <p>Remove explicit role="button" from all native button elements. Only use ARIA roles when creating custom interactive elements from non-semantic elements.</p>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Missing Live Region for Log Updates</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 4.1.3 Status Messages (Level AA)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Live log feed does not announce updates to screen reader users.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:742-747</code></p>
        
        <h4>Recommended Fix:</h4>
        <pre><code>&lt;div className="flex items-center gap-2 text-green-700"&gt;
  &lt;div 
    className="w-2 h-2 bg-green-500 rounded-full animate-pulse"
    aria-hidden="true"
  /&gt;
  &lt;span 
    className="text-sm font-medium"
    role="status"
    aria-live="polite"
    aria-atomic="true"
  &gt;
    Live feed active - {filteredLogs.length} logs
  &lt;/span&gt;
&lt;/div&gt;</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Missing Form Field Associations</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.3.1 Info and Relationships (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Checkbox inputs in filter dropdown lack proper label associations.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:650-671</code></p>
        
        <h4>Current Code:</h4>
        <pre><code>&lt;label key={level} className="flex items-center"&gt;
  &lt;input
    type="checkbox"
    checked={filters.level?.includes(level) || false}
    onChange={(e) =&gt; {...}}
    className="mr-2 rounded"
  /&gt;
  &lt;span className={...}&gt;{level}&lt;/span&gt;
&lt;/label&gt;</code></pre>
        
        <h4>Recommended Fix:</h4>
        <pre><code>&lt;label key={level} className="flex items-center"&gt;
  &lt;input
    id={`filter-level-${level}`}
    type="checkbox"
    checked={filters.level?.includes(level) || false}
    onChange={(e) =&gt; {...}}
    className="mr-2 rounded"
    aria-label={`Filter by ${level} level`}
  /&gt;
  &lt;span className={...}&gt;{level}&lt;/span&gt;
&lt;/label&gt;</code></pre>
    </div>
</div>

<!-- Keyboard Navigation Assessment -->
<div class="section">
    <h2>Keyboard Navigation Issues</h2>
    
    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-error);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-error);">Missing Focus Indicators</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 2.4.7 Focus Visible (Level AA)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Critical</p>
            </div>
            <span class="badge badge-error">Critical</span>
        </div>
        <p style="margin: 1rem 0;">Custom button styles remove default focus outlines without providing accessible alternatives.</p>
        
        <h4>Issue in Tailwind Config:</h4>
        <pre><code>// Many buttons use focus:ring-2 but lack visible outline
className="... focus:outline-none focus:ring-2 focus:ring-primary ..."</code></pre>
        
        <h4>Problems:</h4>
        <ul>
            <li>focus:outline-none removes browser default focus indicator</li>
            <li>focus:ring-2 may not be visible on all backgrounds</li>
            <li>No focus-visible pseudo-class for keyboard-only focus</li>
        </ul>
        
        <h4>Recommended Fix:</h4>
        <pre><code>/* In index.css */
*:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* For interactive elements */
button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
}</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Modal Focus Trap Missing</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 2.1.2 No Keyboard Trap (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Log details modal doesn't trap focus within modal when open.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:813-872</code></p>
        
        <h4>Issue:</h4>
        <p>Tab key can move focus outside modal to background content. Focus should be trapped within modal until dismissed.</p>
        
        <h4>Recommended Implementation:</h4>
        <pre><code>import { useEffect, useRef } from 'react';

const LogDetailModal = ({ log, onClose }) =&gt; {
  const modalRef = useRef&lt;HTMLDivElement&gt;(null);
  const previousFocusRef = useRef&lt;HTMLElement | null&gt;(null);
  
  useEffect(() =&gt; {
    // Store previous focus
    previousFocusRef.current = document.activeElement as HTMLElement;
    
    // Focus modal
    modalRef.current?.focus();
    
    // Handle Tab key for focus trap
    const handleKeyDown = (e: KeyboardEvent) =&gt; {
      if (e.key === 'Tab') {
        const focusableElements = modalRef.current?.querySelectorAll(
          'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );
        
        if (!focusableElements || focusableElements.length === 0) return;
        
        const firstElement = focusableElements[0] as HTMLElement;
        const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;
        
        if (e.shiftKey && document.activeElement === firstElement) {
          e.preventDefault();
          lastElement.focus();
        } else if (!e.shiftKey && document.activeElement === lastElement) {
          e.preventDefault();
          firstElement.focus();
        }
      }
      
      if (e.key === 'Escape') {
        onClose();
      }
    };
    
    document.addEventListener('keydown', handleKeyDown);
    
    return () =&gt; {
      document.removeEventListener('keydown', handleKeyDown);
      // Restore focus
      previousFocusRef.current?.focus();
    };
  }, [onClose]);
  
  return (
    &lt;div
      ref={modalRef}
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
      tabIndex={-1}
      className="..."
    &gt;
      &lt;h3 id="modal-title"&gt;Log Details&lt;/h3&gt;
      {/* Modal content */}
    &lt;/div&gt;
  );
};</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Dropdown Click-Outside Handler Issues</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 2.1.1 Keyboard (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Dropdowns close on click outside but don't properly handle Escape key.</p>
        
        <h4>Location:</h4>
        <p><code>.context-kit/dashboard/src/App.tsx:552-563</code></p>
        
        <h4>Recommended Enhancement:</h4>
        <pre><code>// Add keyboard handler for Escape key
const handleKeyDown = useCallback((event: KeyboardEvent) =&gt; {
  if (event.key === 'Escape') {
    if (showFilters) {
      setShowFilters(false);
      // Return focus to trigger button
      document.querySelector('[aria-controls="filter-dropdown"]')?.focus();
    }
  }
}, [showFilters]);

useEffect(() =&gt; {
  document.addEventListener('keydown', handleKeyDown);
  return () =&gt; document.removeEventListener('keydown', handleKeyDown);
}, [handleKeyDown]);</code></pre>
    </div>
</div>

<!-- Color Contrast Analysis -->
<div class="section">
    <h2>Color Contrast Violations</h2>
    
    <div class="card" style="margin-bottom: 1rem;">
        <h3>Contrast Ratio Requirements</h3>
        <table>
            <thead>
                <tr>
                    <th>Content Type</th>
                    <th>WCAG AA</th>
                    <th>WCAG AAA</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Normal text (< 18pt)</td>
                    <td><strong>4.5:1</strong></td>
                    <td>7:1</td>
                </tr>
                <tr>
                    <td>Large text (‚â• 18pt or ‚â•14pt bold)</td>
                    <td><strong>3:1</strong></td>
                    <td>4.5:1</td>
                </tr>
                <tr>
                    <td>UI components & graphics</td>
                    <td><strong>3:1</strong></td>
                    <td>N/A</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Low Contrast in Status Badges</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.4.3 Contrast (Minimum) Level AA</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        
        <h4>Issues Found:</h4>
        <table style="margin: 1rem 0;">
            <thead>
                <tr>
                    <th>Element</th>
                    <th>Colors</th>
                    <th>Ratio</th>
                    <th>Required</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Warning badge</td>
                    <td>#f59e0b on #fef3c7</td>
                    <td><strong>2.8:1</strong></td>
                    <td>4.5:1</td>
                    <td><span class="badge badge-error">Fail</span></td>
                </tr>
                <tr>
                    <td>Info badge</td>
                    <td>#3b82f6 on #dbeafe</td>
                    <td><strong>3.2:1</strong></td>
                    <td>4.5:1</td>
                    <td><span class="badge badge-error">Fail</span></td>
                </tr>
                <tr>
                    <td>Success badge</td>
                    <td>#10b981 on #d1fae5</td>
                    <td><strong>3.4:1</strong></td>
                    <td>4.5:1</td>
                    <td><span class="badge badge-error">Fail</span></td>
                </tr>
            </tbody>
        </table>
        
        <h4>Recommended Color Adjustments:</h4>
        <pre><code>/* In tailwind.config.js - Use darker text colors */
colors: {
  'warning-text': '#92400e',  // amber-800 (7.2:1 on amber-50)
  'info-text': '#1e40af',     // blue-800 (7.5:1 on blue-50)
  'success-text': '#065f46',  // emerald-800 (7.1:1 on emerald-50)
}

/* Update badge component usage */
status === 'warning' && 'bg-amber-50 text-amber-800'
status === 'info' && 'bg-blue-50 text-blue-800'
status === 'healthy' && 'bg-emerald-50 text-emerald-800'</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-info);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-info);">Gray Text on Light Backgrounds</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.4.3 Contrast (Minimum) Level AA</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Info</p>
            </div>
            <span class="badge badge-info">Info</span>
        </div>
        
        <h4>Issues Found:</h4>
        <table style="margin: 1rem 0;">
            <thead>
                <tr>
                    <th>Element</th>
                    <th>Colors</th>
                    <th>Ratio</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Secondary text (text-gray-500)</td>
                    <td>#6b7280 on #ffffff</td>
                    <td><strong>4.6:1</strong></td>
                    <td><span class="badge badge-success">Pass</span></td>
                </tr>
                <tr>
                    <td>Tertiary text (text-gray-400)</td>
                    <td>#9ca3af on #ffffff</td>
                    <td><strong>2.9:1</strong></td>
                    <td><span class="badge badge-warning">Caution</span></td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin: 1rem 0;">Consider using text-gray-600 (#4b5563) for better contrast (7.0:1 ratio) on non-critical secondary text.</p>
    </div>
</div>

<!-- Screen Reader Compatibility -->
<div class="section">
    <h2>Screen Reader Compatibility</h2>
    
    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-error);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-error);">Decorative Icons Not Hidden</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 1.1.1 Non-text Content (Level A)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Critical</p>
            </div>
            <span class="badge badge-error">Critical</span>
        </div>
        <p style="margin: 1rem 0;">Lucide React icons are announced to screen readers even when purely decorative.</p>
        
        <h4>Issue:</h4>
        <p>Icon components like <code>&lt;Server /&gt;</code>, <code>&lt;AlertCircle /&gt;</code>, etc. are read by screen readers, causing redundant announcements.</p>
        
        <h4>Examples:</h4>
        <pre><code>&lt;!-- Current (BAD) --&gt;
&lt;Server className="w-6 h-6" /&gt;
&lt;span&gt;API Gateway&lt;/span&gt;

&lt;!-- Announced as: "Server graphic. API Gateway" --&gt;

&lt;!-- Fixed (GOOD) --&gt;
&lt;Server className="w-6 h-6" aria-hidden="true" /&gt;
&lt;span&gt;API Gateway&lt;/span&gt;

&lt;!-- Announced as: "API Gateway" only --&gt;</code></pre>
        
        <h4>Global Fix:</h4>
        <p>Create an Icon wrapper component that automatically handles aria-hidden:</p>
        <pre><code>// Icon.tsx
interface IconProps {
  icon: React.ComponentType&lt;{ className?: string }&gt;;
  className?: string;
  label?: string; // If icon has semantic meaning
}

export const Icon: React.FC&lt;IconProps&gt; = ({ icon: IconComponent, className, label }) =&gt; {
  if (label) {
    return &lt;IconComponent className={className} role="img" aria-label={label} /&gt;;
  }
  return &lt;IconComponent className={className} aria-hidden="true" /&gt;;
};</code></pre>
    </div>

    <div class="card" style="margin-bottom: 1rem; border-left: 4px solid var(--color-warning);">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="color: var(--color-warning);">Dynamic Content Updates Not Announced</h3>
                <p style="margin: 0.5rem 0;"><strong>WCAG:</strong> 4.1.3 Status Messages (Level AA)</p>
                <p style="margin: 0.5rem 0;"><strong>Severity:</strong> Warning</p>
            </div>
            <span class="badge badge-warning">Warning</span>
        </div>
        <p style="margin: 1rem 0;">Service status changes and log updates occur without screen reader announcement.</p>
        
        <h4>Recommended Fix:</h4>
        <pre><code>// Add announcement utility
const announce = (message: string, priority: 'polite' | 'assertive' = 'polite') =&gt; {
  const announcement = document.createElement('div');
  announcement.setAttribute('role', 'status');
  announcement.setAttribute('aria-live', priority);
  announcement.setAttribute('aria-atomic', 'true');
  announcement.className = 'sr-only';
  announcement.textContent = message;
  document.body.appendChild(announcement);
  setTimeout(() =&gt; document.body.removeChild(announcement), 1000);
};

// Use in components
useEffect(() =&gt; {
  if (service.status === 'error') {
    announce(`Warning: ${service.name} is experiencing errors`, 'assertive');
  }
}, [service.status]);</code></pre>
    </div>
</div>

<!-- Prioritized Recommendations -->
<div class="section">
    <h2>Prioritized Remediation Roadmap</h2>
    
    <div class="card" style="border-left: 4px solid var(--color-error);">
        <h3 style="color: var(--color-error);">Priority 1: Critical (Must Fix)</h3>
        <p style="margin: 0.5rem 0 1rem 0;">These issues prevent basic accessibility compliance. Fix immediately.</p>
        <ol style="line-height: 2;">
            <li><strong>Add aria-hidden="true" to all decorative icons</strong>
                <ul><li>Estimated effort: 2 hours</li><li>Impact: Eliminates redundant announcements for screen reader users</li></ul>
            </li>
            <li><strong>Fix all icon-only button labels</strong>
                <ul><li>Estimated effort: 1 hour</li><li>Impact: Makes critical actions discoverable to AT users</li></ul>
            </li>
            <li><strong>Implement visible focus indicators</strong>
                <ul><li>Estimated effort: 3 hours</li><li>Impact: Enables keyboard navigation visibility</li></ul>
            </li>
            <li><strong>Fix heading hierarchy</strong>
                <ul><li>Estimated effort: 2 hours</li><li>Impact: Proper document structure for screen readers</li></ul>
            </li>
            <li><strong>Add proper semantic landmarks (main, nav)</strong>
                <ul><li>Estimated effort: 1 hour</li><li>Impact: Enables landmark navigation</li></ul>
            </li>
            <li><strong>Remove redundant ARIA roles from native elements</strong>
                <ul><li>Estimated effort: 1 hour</li><li>Impact: Follows ARIA best practices</li></ul>
            </li>
        </ol>
        <p style="margin-top: 1rem;"><strong>Total estimated effort: 10 hours</strong></p>
    </div>

    <div class="card" style="border-left: 4px solid var(--color-warning); margin-top: 1rem;">
        <h3 style="color: var(--color-warning);">Priority 2: Important (Should Fix)</h3>
        <p style="margin: 0.5rem 0 1rem 0;">These enhance usability significantly. Address within sprint.</p>
        <ol style="line-height: 2;">
            <li><strong>Implement modal focus trap</strong>
                <ul><li>Estimated effort: 3 hours</li><li>Impact: Proper modal keyboard behavior</li></ul>
            </li>
            <li><strong>Fix color contrast in status badges</strong>
                <ul><li>Estimated effort: 2 hours</li><li>Impact: Readable for users with low vision</li></ul>
            </li>
            <li><strong>Add aria-live regions for dynamic updates</strong>
                <ul><li>Estimated effort: 4 hours</li><li>Impact: Screen readers announce status changes</li></ul>
            </li>
            <li><strong>Improve form field labeling</strong>
                <ul><li>Estimated effort: 2 hours</li><li>Impact: Better form accessibility</li></ul>
            </li>
            <li><strong>Add search landmark with proper labeling</strong>
                <ul><li>Estimated effort: 1 hour</li><li>Impact: Discoverable search functionality</li></ul>
            </li>
        </ol>
        <p style="margin-top: 1rem;"><strong>Total estimated effort: 12 hours</strong></p>
    </div>

    <div class="card" style="border-left: 4px solid var(--color-info); margin-top: 1rem;">
        <h3 style="color: var(--color-info);">Priority 3: Enhancement (Nice to Have)</h3>
        <p style="margin: 0.5rem 0 1rem 0;">These provide polish and exceed minimum requirements.</p>
        <ol style="line-height: 2;">
            <li><strong>Add skip links for keyboard users</strong>
                <ul><li>Estimated effort: 2 hours</li></ul>
            </li>
            <li><strong>Enhance keyboard shortcuts (/ for search, ? for help)</strong>
                <ul><li>Estimated effort: 4 hours</li></ul>
            </li>
            <li><strong>Improve ARIA descriptions for complex widgets</strong>
                <ul><li>Estimated effort: 3 hours</li></ul>
            </li>
        </ol>
        <p style="margin-top: 1rem;"><strong>Total estimated effort: 9 hours</strong></p>
    </div>
</div>

<!-- Quick Actions -->
<div class="section">
    <h2>Quick Actions</h2>
    <div class="quick-action-buttons" style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="#" onclick="generatePlan('Fix Critical Accessibility Issues'); return false;" class="quick-action-btn" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--color-error); color: white; border-radius: 0.5rem; text-decoration: none; font-weight: 500;">
            Fix Critical Issues
        </a>
        <a href="#" onclick="generatePlan('Improve Color Contrast'); return false;" class="quick-action-btn" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--color-warning); color: white; border-radius: 0.5rem; text-decoration: none; font-weight: 500;">
            Improve Color Contrast
        </a>
        <a href="#" onclick="generatePlan('Enhance Keyboard Navigation'); return false;" class="quick-action-btn" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--color-info); color: white; border-radius: 0.5rem; text-decoration: none; font-weight: 500;">
            Enhance Keyboard Navigation
        </a>
        <a href="#" onclick="generatePlan('Add ARIA Live Regions'); return false;" class="quick-action-btn" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--color-success); color: white; border-radius: 0.5rem; text-decoration: none; font-weight: 500;">
            Add ARIA Live Regions
        </a>
    </div>
</div>

<!-- Testing Recommendations -->
<div class="section">
    <h2>Testing Recommendations</h2>
    
    <div class="card">
        <h3>Automated Testing Tools</h3>
        <ul style="margin-top: 1rem; line-height: 2;">
            <li><strong>axe DevTools:</strong> Browser extension for in-page accessibility testing</li>
            <li><strong>WAVE:</strong> Web accessibility evaluation tool</li>
            <li><strong>Lighthouse:</strong> Built into Chrome DevTools (Accessibility audit)</li>
            <li><strong>Pa11y CI:</strong> Automated accessibility testing in CI/CD pipeline</li>
        </ul>
    </div>

    <div class="card" style="margin-top: 1rem;">
        <h3>Manual Testing Checklist</h3>
        <ul style="margin-top: 1rem; line-height: 2;">
            <li>‚òê Test all functionality with keyboard only (no mouse)</li>
            <li>‚òê Test with screen reader (NVDA, JAWS, VoiceOver)</li>
            <li>‚òê Test at 200% zoom level</li>
            <li>‚òê Test with Windows High Contrast Mode</li>
            <li>‚òê Test with browser dark mode</li>
            <li>‚òê Validate HTML structure with Nu Html Checker</li>
        </ul>
    </div>

    <div class="card" style="margin-top: 1rem;">
        <h3>Screen Reader Testing Matrix</h3>
        <table>
            <thead>
                <tr>
                    <th>Screen Reader</th>
                    <th>Browser</th>
                    <th>Platform</th>
                    <th>Market Share</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>JAWS</strong></td>
                    <td>Chrome, Firefox</td>
                    <td>Windows</td>
                    <td>40%</td>
                </tr>
                <tr>
                    <td><strong>NVDA</strong></td>
                    <td>Chrome, Firefox</td>
                    <td>Windows</td>
                    <td>30%</td>
                </tr>
                <tr>
                    <td><strong>VoiceOver</strong></td>
                    <td>Safari</td>
                    <td>macOS/iOS</td>
                    <td>20%</td>
                </tr>
                <tr>
                    <td><strong>TalkBack</strong></td>
                    <td>Chrome</td>
                    <td>Android</td>
                    <td>10%</td>
                </tr>
            </tbody>
        </table>
        <p style="margin-top: 1rem;"><strong>Recommendation:</strong> Test with at minimum NVDA + Chrome (free) and VoiceOver + Safari (built-in to Mac).</p>
    </div>
</div>

        </main>

        <!-- Footer -->
        <footer>
            <p><strong>Accessibility Audit Report</strong></p>
            <p style="margin-top: 0.5rem;">Generated by accessibility-agent | W3C Design Token Format 3.0 Compliant</p>
            <p style="margin-top: 0.5rem;">tkr-project-kit 3.6.0 | 2025-01-30</p>
            <p style="margin-top: 1rem; font-size: var(--font-size-xs);">
                <a href="https://github.com/tuckertucker/tkr-project-kit" target="_blank" rel="noopener">GitHub</a> |
                <a href="../../index.html">All Reports</a> |
                <a href="#" onclick="window.print(); return false;">Print</a>
            </p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="../../assets/js/navigation.js"></script>
    <script src="../../assets/js/theme-toggle.js"></script>

    <!-- Custom Report Script (optional) -->
    
<script>
function generatePlan(recommendation) {
    const reportPath = window.location.pathname;
    const message = `/create_plan ${recommendation} - ${reportPath}`;
    
    // Create modal with instruction
    const modal = document.createElement('div');
    modal.style.cssText = 'position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;';
    modal.innerHTML = `
        <div style="background: white; padding: 2rem; border-radius: 0.75rem; max-width: 500px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 1rem 0; font-size: 1.25rem; font-weight: 600;">Generate Implementation Plan</h3>
            <p style="margin: 0 0 1rem 0; color: #6b7280;">Copy this command to Claude Code:</p>
            <pre style="background: #f3f4f6; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin: 0 0 1rem 0; font-size: 0.875rem;">${message}</pre>
            <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                <button onclick="this.closest('div').parentElement.remove()" style="padding: 0.5rem 1rem; border: 1px solid #d1d5db; background: white; border-radius: 0.5rem; cursor: pointer;">
                    Close
                </button>
                <button onclick="navigator.clipboard.writeText('${message}'); this.textContent='Copied!'" style="padding: 0.5rem 1rem; background: #3b82f6; color: white; border: none; border-radius: 0.5rem; cursor: pointer; font-weight: 500;">
                    Copy Command
                </button>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
    modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
}
</script>

</body>
</html>